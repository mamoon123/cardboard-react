{"ast":null,"code":"import _defineProperty from\"/Users/irfan/personal/cardboard-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/irfan/personal/cardboard-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/irfan/personal/cardboard-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/* eslint-disable jsx-a11y/anchor-is-valid */import React,{useState,useEffect}from'react';import{useCookies}from'react-cookie';import{get}from'lodash/fp';import{AuthForm,SubmitButton}from'./AuthStyle';import{VALID_EMAIL_REGEX,ACCESS_TOKEN,USER}from'../Constant';import{MAXIMUM_EMAIL_LENGTH}from'../ValidationLength';var Signin=function Signin(){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),formErrors=_useState2[0],setFormErrors=_useState2[1];var _useCookies=useCookies([ACCESS_TOKEN]),_useCookies2=_slicedToArray(_useCookies,2),cookies=_useCookies2[0],setCookie=_useCookies2[1];var token=cookies[ACCESS_TOKEN];var _useState3=useState({email:'',password:''}),_useState4=_slicedToArray(_useState3,2),register=_useState4[0],setRegister=_useState4[1];var email=register.email,password=register.password;useEffect(function(){var errors={email:''};if(!email){errors.email='';}else if(!VALID_EMAIL_REGEX.test(email)){errors.email='*Please enter valid email';}else if(!(email.length<=MAXIMUM_EMAIL_LENGTH)){errors.email=\"Email should not exceed \".concat(MAXIMUM_EMAIL_LENGTH,\" characters\");}console.log(register);console.log(errors);setFormErrors(errors);},[email,register]);var onInputChange=function onInputChange(evt){setRegister(_objectSpread(_objectSpread({},register),{},_defineProperty({},evt.target.name,evt.target.value)));};var confirm=function confirm(response){var access_token=response.access_token,user=response.user;if(access_token){setCookie(USER,user);setCookie(ACCESS_TOKEN,access_token);console.log(access_token);}else{console.log(response.message);}};var onFormSubmit=function onFormSubmit(evt){evt.preventDefault();console.log(register);fetch(\"http://localhost:3000/api/v1/auth/login\",{\"method\":\"POST\",\"headers\":{\"content-type\":\"application/json\",\"accept\":\"application/json\"},\"body\":JSON.stringify({email:email,password:password})}).then(function(response){return response.json();}).then(function(response){confirm(response);}).catch(function(err){debugger;console.log(err);});};if(token){window.location.href='/orders';}return/*#__PURE__*/React.createElement(AuthForm,null,/*#__PURE__*/React.createElement(\"form\",{onSubmit:onFormSubmit,method:\"post\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{className:\"input-label\",for:\"email\"},\"Email address:\"),/*#__PURE__*/React.createElement(\"input\",{type:\"email\",name:\"email\",className:\"form-control\",id:\"email\",required:true,value:email,onChange:onInputChange,error:get('email',formErrors)})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{className:\"input-label\",for:\"pwd\"},\"Password:\"),/*#__PURE__*/React.createElement(\"input\",{type:\"password\",name:\"password\",className:\"form-control\",id:\"pwd\",required:true,value:password,onChange:onInputChange})),/*#__PURE__*/React.createElement(\"div\",{className:\"checkbox\"},/*#__PURE__*/React.createElement(\"label\",{className:\"input-label\"},/*#__PURE__*/React.createElement(\"input\",{type:\"checkbox\"}),\" Remember me\")),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(SubmitButton,{className:\"form-group\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn btn-default\"},\"Submit\"))));};export default Signin;","map":{"version":3,"sources":["/Users/irfan/personal/cardboard-react/src/Components/Auth/Signin.js"],"names":["React","useState","useEffect","useCookies","get","AuthForm","SubmitButton","VALID_EMAIL_REGEX","ACCESS_TOKEN","USER","MAXIMUM_EMAIL_LENGTH","Signin","formErrors","setFormErrors","cookies","setCookie","token","email","password","register","setRegister","errors","test","length","console","log","onInputChange","evt","target","name","value","confirm","response","access_token","user","message","onFormSubmit","preventDefault","fetch","JSON","stringify","then","json","catch","err","window","location","href"],"mappings":"qdAAA,6CACA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,UAAT,KAA2B,cAA3B,CACA,OAASC,GAAT,KAAoB,WAApB,CACA,OAASC,QAAT,CAAmBC,YAAnB,KAAuC,aAAvC,CACA,OAASC,iBAAT,CAA4BC,YAA5B,CAA0CC,IAA1C,KAAsD,aAAtD,CACA,OAASC,oBAAT,KAAqC,qBAArC,CAGA,GAAMC,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,EAAM,eACiBV,QAAQ,CAAC,EAAD,CADzB,wCACZW,UADY,eACAC,aADA,+BAEUV,UAAU,CAAC,CAACK,YAAD,CAAD,CAFpB,4CAEZM,OAFY,iBAEHC,SAFG,iBAGnB,GAAMC,CAAAA,KAAK,CAAGF,OAAO,CAACN,YAAD,CAArB,CAHmB,eAIaP,QAAQ,CAAC,CACvCgB,KAAK,CAAE,EADgC,CAEvCC,QAAQ,CAAE,EAF6B,CAAD,CAJrB,yCAIZC,QAJY,eAIFC,WAJE,kBASjBH,CAAAA,KATiB,CAWfE,QAXe,CASjBF,KATiB,CAUjBC,QAViB,CAWfC,QAXe,CAUjBD,QAViB,CAanBhB,SAAS,CAAC,UAAM,CACd,GAAMmB,CAAAA,MAAM,CAAG,CACbJ,KAAK,CAAE,EADM,CAAf,CAIA,GAAI,CAACA,KAAL,CAAY,CACVI,MAAM,CAACJ,KAAP,CAAe,EAAf,CACD,CAFD,IAEO,IAAI,CAACV,iBAAiB,CAACe,IAAlB,CAAuBL,KAAvB,CAAL,CAAoC,CACzCI,MAAM,CAACJ,KAAP,CAAe,2BAAf,CACD,CAFM,IAEA,IAAI,EAAEA,KAAK,CAACM,MAAN,EAAgBb,oBAAlB,CAAJ,CAA6C,CAClDW,MAAM,CAACJ,KAAP,mCAA0CP,oBAA1C,gBACD,CACDc,OAAO,CAACC,GAAR,CAAYN,QAAZ,EACAK,OAAO,CAACC,GAAR,CAAYJ,MAAZ,EACAR,aAAa,CAACQ,MAAD,CAAb,CACD,CAfQ,CAeN,CAACJ,KAAD,CAAQE,QAAR,CAfM,CAAT,CAiBA,GAAMO,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACC,GAAD,CAAS,CAC7BP,WAAW,gCACND,QADM,wBAERQ,GAAG,CAACC,MAAJ,CAAWC,IAFH,CAEUF,GAAG,CAACC,MAAJ,CAAWE,KAFrB,GAAX,CAID,CALD,CAOA,GAAMC,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,CAACC,QAAD,CAAc,IACpBC,CAAAA,YADoB,CACGD,QADH,CACpBC,YADoB,CACNC,IADM,CACGF,QADH,CACNE,IADM,CAE5B,GAAID,YAAJ,CAAkB,CAChBlB,SAAS,CAACN,IAAD,CAAOyB,IAAP,CAAT,CACAnB,SAAS,CAACP,YAAD,CAAeyB,YAAf,CAAT,CACAT,OAAO,CAACC,GAAR,CAAYQ,YAAZ,EACD,CAJD,IAIO,CACLT,OAAO,CAACC,GAAR,CAAYO,QAAQ,CAACG,OAArB,EACD,CACF,CATD,CAWA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACT,GAAD,CAAS,CAC5BA,GAAG,CAACU,cAAJ,GACAb,OAAO,CAACC,GAAR,CAAYN,QAAZ,EACAmB,KAAK,CAAC,yCAAD,CAA4C,CAC/C,SAAU,MADqC,CAE/C,UAAW,CACT,eAAgB,kBADP,CAET,SAAU,kBAFD,CAFoC,CAM/C,OAAQC,IAAI,CAACC,SAAL,CAAe,CACrBvB,KAAK,CAAEA,KADc,CAErBC,QAAQ,CAAEA,QAFW,CAAf,CANuC,CAA5C,CAAL,CAWCuB,IAXD,CAWM,SAAAT,QAAQ,QAAIA,CAAAA,QAAQ,CAACU,IAAT,EAAJ,EAXd,EAYCD,IAZD,CAYM,SAAAT,QAAQ,CAAI,CAChBD,OAAO,CAACC,QAAD,CAAP,CACD,CAdD,EAeCW,KAfD,CAeO,SAAAC,GAAG,CAAI,CACZ,SACApB,OAAO,CAACC,GAAR,CAAYmB,GAAZ,EACD,CAlBD,EAmBD,CAtBD,CAwBA,GAAI5B,KAAJ,CAAW,CACT6B,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAuB,SAAvB,CACD,CAGD,mBACE,oBAAC,QAAD,mBACE,4BACE,QAAQ,CAAEX,YADZ,CAEE,MAAM,CAAC,MAFT,eAIE,2BAAK,SAAS,CAAC,YAAf,eACI,6BAAO,SAAS,CAAC,aAAjB,CAA+B,GAAG,CAAC,OAAnC,mBADJ,cAEI,6BACE,IAAI,CAAC,OADP,CAEE,IAAI,CAAC,OAFP,CAGE,SAAS,CAAC,cAHZ,CAIE,EAAE,CAAC,OAJL,CAKE,QAAQ,KALV,CAME,KAAK,CAAEnB,KANT,CAOE,QAAQ,CAAES,aAPZ,CAQE,KAAK,CAAEtB,GAAG,CAAC,OAAD,CAAUQ,UAAV,CARZ,EAFJ,CAJF,cAiBI,2BAAK,SAAS,CAAC,YAAf,eACE,6BAAO,SAAS,CAAC,aAAjB,CAA+B,GAAG,CAAC,KAAnC,cADF,cAEE,6BACE,IAAI,CAAC,UADP,CAEE,IAAI,CAAC,UAFP,CAGE,SAAS,CAAC,cAHZ,CAIE,EAAE,CAAC,KAJL,CAKE,QAAQ,KALV,CAME,KAAK,CAAEM,QANT,CAOE,QAAQ,CAAEQ,aAPZ,EAFF,CAjBJ,cA6BE,2BAAK,SAAS,CAAC,UAAf,eACE,6BAAO,SAAS,CAAC,aAAjB,eAA+B,6BAAO,IAAI,CAAC,UAAZ,EAA/B,gBADF,CA7BF,cAgCE,8BAhCF,cAiCE,oBAAC,YAAD,EAAc,SAAS,CAAC,YAAxB,eACE,8BAAQ,IAAI,CAAC,QAAb,CAAsB,SAAS,CAAC,iBAAhC,WADF,CAjCF,CADF,CADF,CAyCD,CAtHD,CAyHA,cAAef,CAAAA,MAAf","sourcesContent":["/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { useState, useEffect } from 'react';\nimport { useCookies } from 'react-cookie';\nimport { get } from 'lodash/fp';\nimport { AuthForm, SubmitButton } from './AuthStyle';\nimport { VALID_EMAIL_REGEX, ACCESS_TOKEN, USER } from '../Constant';\nimport { MAXIMUM_EMAIL_LENGTH } from '../ValidationLength';\n\n\nconst Signin = () => {\n  const [formErrors, setFormErrors] = useState({});\n  const [cookies, setCookie] = useCookies([ACCESS_TOKEN]);\n  const token = cookies[ACCESS_TOKEN];\n  const [register, setRegister] = useState({\n    email: '',\n    password: '',\n  });\n  const {\n    email,\n    password,\n  } = register;\n\n  useEffect(() => {\n    const errors = {\n      email: '',\n    };\n\n    if (!email) {\n      errors.email = '';\n    } else if (!VALID_EMAIL_REGEX.test(email)) {\n      errors.email = '*Please enter valid email';\n    } else if (!(email.length <= MAXIMUM_EMAIL_LENGTH)) {\n      errors.email = `Email should not exceed ${MAXIMUM_EMAIL_LENGTH} characters`;\n    }\n    console.log(register)\n    console.log(errors)\n    setFormErrors(errors);\n  }, [email, register]);\n\n  const onInputChange = (evt) => {\n    setRegister({\n      ...register,\n      [evt.target.name]: evt.target.value,\n    });\n  };\n\n  const confirm = (response) => {\n    const { access_token, user } = response;\n    if (access_token) {\n      setCookie(USER, user);\n      setCookie(ACCESS_TOKEN, access_token);\n      console.log(access_token)\n    } else {\n      console.log(response.message)\n    }\n  }\n\n  const onFormSubmit = (evt) => {\n    evt.preventDefault();\n    console.log(register)\n    fetch(\"http://localhost:3000/api/v1/auth/login\", {\n      \"method\": \"POST\",\n      \"headers\": {\n        \"content-type\": \"application/json\",\n        \"accept\": \"application/json\"\n      },\n      \"body\": JSON.stringify({\n        email: email,\n        password: password,\n      })\n    })\n    .then(response => response.json())\n    .then(response => {\n      confirm(response);\n    })\n    .catch(err => {\n      debugger\n      console.log(err);\n    });\n  };\n\n  if (token) {\n    window.location.href = '/orders';\n  }\n\n\n  return (\n    <AuthForm>\n      <form\n        onSubmit={onFormSubmit}\n        method=\"post\"\n      >\n        <div className=\"form-group\">\n            <label className=\"input-label\" for=\"email\">Email address:</label>\n            <input \n              type=\"email\" \n              name=\"email\"\n              className=\"form-control\" \n              id=\"email\" \n              required\n              value={email}\n              onChange={onInputChange}\n              error={get('email', formErrors)}\n            />\n          </div>\n          <div className=\"form-group\">\n            <label className=\"input-label\" for=\"pwd\">Password:</label>\n            <input \n              type=\"password\"\n              name=\"password\"\n              className=\"form-control\" \n              id=\"pwd\"\n              required\n              value={password}\n              onChange={onInputChange}\n            />\n          </div>\n        <div className=\"checkbox\">\n          <label className=\"input-label\"><input type=\"checkbox\" /> Remember me</label>\n        </div>\n        <br></br>\n        <SubmitButton className=\"form-group\">\n          <button type=\"submit\" className=\"btn btn-default\">Submit</button>\n        </SubmitButton>\n      </form>\n    </AuthForm>\n  );\n};\n\n\nexport default Signin;\n"]},"metadata":{},"sourceType":"module"}